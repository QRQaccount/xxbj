# k60的PWM的使用

脉冲宽度调制，利用数字输出对模拟信号进行控制

## 配置K60的配置

例如常见的方波就是为50%占空比的PWM波

1. PWM波的频率(周期)

2. PWM的占空比

## K60的pwm的产生

由FTM多功能定时器/计数器

+ 由多功能计时器捕获脉冲输入

+ 功能
  
  + 产生输出比较和定时中断
  
  + 输出PWM方波

在使用PWM波时，使用的是它的计数模块。FTM在PWM方波的时候对信号的上升沿进行计数。计数范围是0-65535

> 一般来讲舵机和电机使用的PWM的频率是50Hz到100Hz

## 使用龙邱的库进行操作

```c
int main(){
    PLL_Init(PLL180); // 初始化PLL为180Mhz BUS 90Mhz
    FTM_PWM_Init(FTM0,FTM_CH0,56250,28125); //从前到后 选择工作模式,通道选择,初始BUS时钟,占空比计算值 现在是100Mhz占空比是50%的设置
    return 0;    
}
```

### 数值的计算

计算公式

$$
\frac{f_0}{Divide*f}
$$

1. f0为输入的脉冲信号频率

2. Divide为分频数设置

3. f为输出信号的频率

## 涉及到的寄存器

+ FTMx__SC
  
  + CLKS 4~3位  时钟选择位
    
    1. 00 没有时钟选择
    
    2. 01 系统时钟
    
    3. 10 固定频率滤波器
    
    4. 11 外部时钟
  
  + PS 2~0位  对选取的时钟进行分频
    
    1. 000 一分频
    
    2. 001 二分频
    
    3. 010 四分频
    
    4. 011 八分频
    
    5. 100 16分频
    
    6. 101 32分频
    
    7. 110 64分频
    
    8. 111 128分频

## K60的时钟简介

1. 内核时钟(core)

2. 总线时钟(bus)

3. 外部总线时钟(flexbus)
